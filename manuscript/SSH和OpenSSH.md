### SSH和OpenSSH



#### SSL

* SSL是为网络通信提供安全保障的协议

#### OpenSSL

* 是SSL协议的开源实现

#### SSH

* SSH是一种可以为远程登录提供安全保障的协议

#### OpenSSH

* 是SSH协议的开源实现
* 是基于`OpenSSL`实现的加密

#### OpensSSH使用

##### 登录

```sh
ssh 用户名@地址
```

* 第一次登录的时候，服务端会把自己的公钥发送给客户端，此时客户端需要输入`yes`来保存公钥

* 客户端输入`yes`后，会把公钥以及ip信息保存到`~/.ssh/known_hosts`文件中

* 再次登录的时候，客户端会比较公钥，如果不一样则会连接失败，需要删除记录，才能重新登录，可手动删除或使用如下命令：

  ```sh
  ssh-keygen -R 服务器IP地址
  ```


* 客户端验证有密码和秘钥两种

* 密码验证会使用公钥加密密码发送给服务端

* 秘钥验证需要把客户端公钥添加到服务器的授权文件`~/.ssh/authorized_keys`中

  * 客户端秘钥生成使用如下命令：

    ```sh
    ssh-keygen 
    ```

    然后一路敲回车，就会在`~/.ssh/`路径下生成一对秘钥

  * 使用`ssh-copy-id 用户名@地址` 会自动把公钥追加到服务器的授权文件中



##### 查看SSH版本

在`/etc/ssh/`文件夹中有两个配置文件`ssh_config`（客户端配置）和`sshd_config`（服务端配置），在对应的配置文件中`Protocol 2`表示使用的是SSH2版本，新版`Mac OC`的配置文件没有这个属性，客户端和服务端的SSH版本需要一样，否则无法访问



#### 其他

```
scp 文件名 用户名@地址:服务器路径
scp ~/123.md root@192.0.0.1:~/123.md 
```

#### 使用USB登录手机

* Mac有个服务`usbmuxd` 可以将Mac数据通过USB传输,具体原理是，将Mac的某个端口的数据通过`usbmuxd`转发到USB另一端的22端口
* 需要将Mac的其他端口映射到22端口，并且登录的时候要登录本机的映射端口
* [ssh over usb](https://iphonedev.wiki/index.php/SSH_Over_USB)



