---
title: swift_node_4
date: 2021-06-24 20:13:38
tags:
---

### 结构体

* 每个结构体都有一个编译器自动生成的初始化器（initializer, 初始化方法，构造器，构造方法）

#### 初始化器

* 编译器会根据情况，可能会为结构体生成多个初始化器，目的是保证所有成员都有初始值
* 如果成员有默认值，则生成的初始化器可以不带该成员
* 在定义结构体时，自定义了初始化器，编译器就不会再帮它生成其他初始化器

### 类

* 类的定义和结构体类似，但编译器并没有为类自动生成可以传入成员值的初始化器
* 如果类的所有成员在定义的时候都指定了初始值，编译器会为类生成无参的初始化器 
* 类在堆中所占内存总是16的倍数（苹果优化），底层`malloc`申请的逻辑，因为内存都是16个字节为一个整体
* 类中定义的方法，存放在代码区，而不是类的内存中

###  结构体（值类型）和类（指针类型）的本质区别

* 结构体是值类型（枚举也是值类型），类是引用类型（指针类型）
* 值类型的数据"指针"所指的内存存放数据，存放在栈空间，指针类型的指针所指的地址空间（64位下是8个字节）存放的是堆内存中的一个地址，数据存放在堆空间 （会有16个字节存储类相关信息 + 其他成员所占内存 ）
* 结构体存储的位置不一定在栈区，而取决于在哪里创建，在全局创建的存储在全局区，在类中的，则创建类的时候在堆中创建，在函数中创建，则在栈中存储
* 值类型赋值给`var`，`let`或者给函数传参，是直接将所有内容拷贝一份，产生的是全新的文件副本，属于深拷贝
* `String`,`Array`,`Dictionary`,`Set`都是值类型的变量，在Swift标准库中，为了提升性能，会采取`Copy on Write`的技术（如果赋值后，并没有修改值，则是浅拷贝，在修改值的时候，才会深拷贝）
* 引用类型赋值给`var`,`let`或者给函数传参，是将内存地址拷贝一份，类似于快捷方式，属于浅拷贝
* `let`修饰的值类型，本身和属性都不能修改，但`let`修饰的指针类型，指针不能修改，但属性可以修改

### 嵌套类型

嵌套类型指的是在结构体类型或指针类型中定义的其他类型，eg： 结构体中定义一个枚举

