---
title: swift_node_5
date: 2021-09-13 16:41:03
tags:
---

### 闭包表达式

* 在`Swift`中，可以通过`func`定义一个函数，也可以通过闭包表达式定义一个函数

* 格式：

  ```swift
  {
  	(参数列表) -> 返回值类型 in
  	函数体代码
  }
  ```

* 如果编译器可以推断出参数类型，则闭包的参数列表中可以省略参数类型，如果只有一行函数体可省略`return`,可以使用`$0 $1` 等代替参数，同时省略 参数列表和`in`

### 尾随闭包

* 尾随闭包是一个呗书写在函数调用括号外面（后面）的闭包表达式，这样函数的参数内容更清楚
* 如果将一个很长的闭包表达式作为函数的最后一个实参，使用尾随闭包可以增强函数的可读性
* 如果闭包表达式是函数的唯一实参，而且使用了尾随闭包的语法，则函数名后面的括号可以省略

### 闭包

* 一个函数和它所捕获的变量、常量环境组合起来，成为闭包

* 一般指定义在函数内部的函数

* 一般它捕获的是外层函数的局部变量、常量 eg：

  ```swift
  func fun() -> () -> () {
  		var a = 10
  		func fn1() {
  				a = 11
  		}
  		return fn1
  }
  ```

* 可以把闭包想象成一个类的实例对象，内存在堆空间，捕获的局部变量、常量就是对象的成员（存储属性），组成闭包的函数就是类内部定义的方法

### 自动闭包

* 对函数参数使用`@autoclosure`修饰是，可以自动将参数封装成闭包的形式
* `@autoclosure`只支持`() -> T`格式的参数
* `@autoclosure`不是只能支持最后一个参数
* 空合并运算符`??`使用了`@autoclosure`技术
* 有`@autoclosure` 无`@autoclosure`,构成了函数重载
* 自动闭包有可能延迟执行，也有可能不执行
